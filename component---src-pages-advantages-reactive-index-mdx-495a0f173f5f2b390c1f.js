(window.webpackJsonp=window.webpackJsonp||[]).push([[30,73,123],{"013z":function(e,t,a){"use strict";var n=a("q1tI"),i=a.n(n),s=a("NmYn"),r=a.n(s),o=a("Wbzz"),c=a("Xrax"),l=a("k4MR"),b=a("TSYQ"),p=a.n(b),d=a("QH2O"),m=a.n(d),u=a("qKvR"),g=function(e){var t,a=e.title,n=e.theme,i=e.tabs,s=void 0===i?[]:i;return Object(u.b)("div",{className:p()(m.a.pageHeader,(t={},t[m.a.withTabs]=s.length,t[m.a.darkMode]="dark"===n,t))},Object(u.b)("div",{className:"bx--grid"},Object(u.b)("div",{className:"bx--row"},Object(u.b)("div",{className:"bx--col-lg-12"},Object(u.b)("h1",{id:"page-title",className:m.a.text},a)))))},h=a("BAC9"),f=function(e){var t=e.relativePagePath,a=e.repository,n=Object(o.useStaticQuery)("1364590287").site.siteMetadata.repository,i=a||n,s=i.baseUrl,r=i.subDirectory,c=s+"/edit/"+i.branch+r+"/src/pages"+t;return s?Object(u.b)("div",{className:"bx--row "+h.row},Object(u.b)("div",{className:"bx--col"},Object(u.b)("a",{className:h.link,href:c},"Edit this page on GitHub"))):null},v=a("FCXl"),A=a("dI71"),y=a("I8xM"),O=function(e){function t(){return e.apply(this,arguments)||this}return Object(A.a)(t,e),t.prototype.render=function(){var e=this.props,t=e.title,a=e.tabs,n=e.slug,i=n.split("/").filter(Boolean).slice(-1)[0],s=a.map((function(e){var t,a=r()(e,{lower:!0,strict:!0}),s=a===i,c=new RegExp(i+"/?(#.*)?$"),l=n.replace(c,a);return Object(u.b)("li",{key:e,className:p()((t={},t[y.selectedItem]=s,t),y.listItem)},Object(u.b)(o.Link,{className:y.link,to:""+l},e))}));return Object(u.b)("div",{className:y.tabsContainer},Object(u.b)("div",{className:"bx--grid"},Object(u.b)("div",{className:"bx--row"},Object(u.b)("div",{className:"bx--col-lg-12 bx--col-no-gutter"},Object(u.b)("nav",{"aria-label":t},Object(u.b)("ul",{className:y.list},s))))))},t}(i.a.Component),w=a("MjG9"),j=a("CzIb"),k=a("Asxa"),N=a("OIbQ"),x=a.n(N),T=function(e){var t=e.date,a=new Date(t);return t?Object(u.b)(k.c,{className:x.a.row},Object(u.b)(k.a,null,Object(u.b)("div",{className:x.a.text},"Page last updated: ",a.toLocaleDateString("en-GB",{day:"2-digit",year:"numeric",month:"long"})))):null};t.a=function(e){var t=e.pageContext,a=e.children,n=e.location,i=e.Title,s=t.frontmatter,b=void 0===s?{}:s,p=t.relativePagePath,d=t.titleType,m=b.tabs,h=b.title,A=b.theme,y=b.description,k=b.keywords,N=b.date,x=Object(j.a)().interiorTheme,C=Object(o.useStaticQuery)("2456312558").site.pathPrefix,E=C?n.pathname.replace(C,""):n.pathname,R=m?E.split("/").filter(Boolean).slice(-1)[0]||r()(m[0],{lower:!0}):"",I=A||x;return Object(u.b)(l.a,{tabs:m,homepage:!1,theme:I,pageTitle:h,pageDescription:y,pageKeywords:k,titleType:d},Object(u.b)(g,{title:i?Object(u.b)(i,null):h,label:"label",tabs:m,theme:I}),m&&Object(u.b)(O,{title:h,slug:E,tabs:m,currentTab:R}),Object(u.b)(w.a,{padded:!0},a,Object(u.b)(f,{relativePagePath:p}),Object(u.b)(T,{date:N})),Object(u.b)(v.a,{pageContext:t,location:n,slug:E,tabs:m,currentTab:R}),Object(u.b)(c.a,null))}},BAC9:function(e,t,a){e.exports={bxTextTruncateEnd:"EditLink-module--bx--text-truncate--end--2pqje",bxTextTruncateFront:"EditLink-module--bx--text-truncate--front--3_lIE",link:"EditLink-module--link--1qzW3",row:"EditLink-module--row--1B9Gk"}},I8xM:function(e,t,a){e.exports={bxTextTruncateEnd:"PageTabs-module--bx--text-truncate--end--267NA",bxTextTruncateFront:"PageTabs-module--bx--text-truncate--front--3xEQF",tabsContainer:"PageTabs-module--tabs-container--8N4k0",list:"PageTabs-module--list--3eFQc",listItem:"PageTabs-module--list-item--nUmtD",link:"PageTabs-module--link--1mDJ1",selectedItem:"PageTabs-module--selected-item--YPVr3"}},OIbQ:function(e,t,a){e.exports={bxTextTruncateEnd:"last-modified-date-module--bx--text-truncate--end--123zi",bxTextTruncateFront:"last-modified-date-module--bx--text-truncate--front--3xeKz",text:"last-modified-date-module--text--24m-4",row:"last-modified-date-module--row--2BquN"}},QH2O:function(e,t,a){e.exports={bxTextTruncateEnd:"PageHeader-module--bx--text-truncate--end--mZWeX",bxTextTruncateFront:"PageHeader-module--bx--text-truncate--front--3zvrI",pageHeader:"PageHeader-module--page-header--3hIan",darkMode:"PageHeader-module--dark-mode--hBrwL",withTabs:"PageHeader-module--with-tabs--3nKxA",text:"PageHeader-module--text--o9LFq"}},s3by:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return o})),a.d(t,"default",(function(){return u}));var n=a("wx14"),i=a("zLVn"),s=(a("q1tI"),a("7ljp")),r=a("013z"),o=(a("qKvR"),{}),c=function(e){return function(t){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),Object(s.b)("div",t)}},l=c("InlineNotification"),b=c("AnchorLinks"),p=c("AnchorLink"),d={_frontmatter:o},m=r.a;function u(e){var t=e.components,a=Object(i.a)(e,["components"]);return Object(s.b)(m,Object(n.a)({},d,a,{components:t,mdxType:"MDXLayout"}),Object(s.b)(l,{kind:"warning",mdxType:"InlineNotification"},Object(s.b)("strong",null,"Updated 1/21/2022 - still working progress")),Object(s.b)("p",null,"This chapter describes how event driven architecture addresses the implementation of reactive systems and\npresents how to design event-driven responsive solutions by using the most recent technologies."),Object(s.b)(b,{mdxType:"AnchorLinks"},Object(s.b)(p,{mdxType:"AnchorLink"},"Overview")," Cloud native, distributed systems, reactive systems...",Object(s.b)(p,{mdxType:"AnchorLink"},"EDA and reactive systems"),Object(s.b)(p,{mdxType:"AnchorLink"},"Technology review")," Vert.x, reactive messaging, mutiny, AMQP, kantive eventing...",Object(s.b)(p,{mdxType:"AnchorLink"},"More...")),Object(s.b)("h2",null,"Overview"),Object(s.b)("h3",null,"Cloud native"),Object(s.b)("p",null,"The ",Object(s.b)("a",{parentName:"p",href:"https://12factor.net/"},"12 factors app")," defines\nthe needs for modern business service apps or webapps to be a good citizen in cloud deployment:"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Codebase"),": One codebase tracked in version control, many deploys."),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Dependencies"),": Explicitly declare and isolate dependencies."),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Config"),": store config in the environment."),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Backing services"),": Treat backing services as attached resources."),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Build, release, run"),": Strictly separate build and run stages."),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Processes"),": Execute the app as one or more stateless (which may be challenged in\ncase of event streaming and real-time analytics) processes"),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Port binding"),": Export services via port binding."),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Concurrency"),": Scale out via the process model."),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Disposability"),": Maximize the robustness with fast startup and graceful shutdown."),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Dev/prod parity"),": Keep development, staging, and production as similar as possible."),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Logs"),": Treat your logs as event streams."),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Admin processes"),": Run admin/management tasks as one-off processes.")),Object(s.b)("p",null,"Achieving cloud native is not an easy task. Avoid vendor locking by using specific vendor\nservices to keep data, messaging… Hybrid cloud applications run on multiple clouds,\nmixing private and public clouds, to reduce response time and prevent global unavailability\nas recently demonstrated by AWS outtages. Kubernetes helps deliver an abstraction on top\nof cloud providers, and uses them as infrastructure as a services, and bring your own platform.\nKubernetes facilitates reactive systems through responsiveness and resilience. "),Object(s.b)("h3",null,"Distributed systems"),Object(s.b)("p",null,"From ",Object(s.b)("a",{parentName:"p",href:"https://www.microsoft.com/en-us/research/publication/specifying-systems-the-tla-language-and-tools-for-hardware-and-software-engineers/"},"Leslie Lamport’s definition"),": "),Object(s.b)("blockquote",null,Object(s.b)("p",{parentName:"blockquote"},"A distributed system is one in which the failure of a computer you didn’t even know existed can render your own computer unusable.")),Object(s.b)("p",null,"We need to design application for transient, intermittent, or complete failure and resilience.\nComplex exchanges involving multiple services cannot expect all the participants and the network\nto be operational for the complete duration of that exchange. "),Object(s.b)("p",null,"We need to ask ourselves: ",Object(s.b)("strong",{parentName:"p"},"How would you detect failures? How would you handle them gracefully?")),Object(s.b)("p",null,"When designing a distributed solution, we need to keep in mind that the CAP theorem prevents\na distributed data store from simultaneously providing more than two\nout of the three guarantees of Consistency, Availability and Partition tolerance. "),Object(s.b)("p",null,"With simple synchronous calls between services leads to time coupling and enforces programming\nin sequence. The code must gracefully handle faulty responses and the absence of response.\nQuarkus/Vert.x has a router that can be intercepted to simulate communication loss, wrong response or delay, this is vertically helpful to test for failure.\nSee ",Object(s.b)("a",{parentName:"p",href:"https://github.com/cescoffier/reactive-systems-in-java/tree/main/chapter-3"},"Clement Escoffier’s code sample"),"."),Object(s.b)("p",null,"Combining time-out and retries, is a common development practice, but we can’t assume the service\nwas not invoked and retrying may reprocess the same request multiple times. Service needs to support\nidempotence: multiple requests with same content, results in the same state and same output.\nIdempotence can be implemented using unique identifiers added to the payload so consumer can identify same request. But server applications need to keep\nstate of those ids, which means using Storage, which is under the CAP theorem. We may\ninclude an in-memory data grid such as Infinispan or Hazelcast, an inventory service such as Apache ZooKeeper,\na distributed cache as Redis. "),Object(s.b)("h3",null,"Reactive systems"),Object(s.b)("p",null,"Modern business applications embrace the strong need to be responsive, bringing immediate\nresponse and feedbacks to the end user or system acting on it at the moment it needed.\nModern solution based on microservices needs to support load increase and failure and developers are\nadopting the reactive manifesto and use modern programming libraries and software to support\nthe manifesto characteristics. "),Object(s.b)("p",null,"The ",Object(s.b)("a",{parentName:"p",href:"https://www.reactivemanifesto.org/"},"reactive manifesto")," defines four characteristics modern cloud native application needs to support:"),Object(s.b)("p",null," ",Object(s.b)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"441px"}},"\n      ",Object(s.b)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"52.43055555555556%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAACfklEQVQoz21RTUhUYRQ97z2HnBnHnxmdMBOLFCUTqYVjwoyMzjj/Tmb+JCoiFhq0iBZBLaRVEGkUrixoke0isEWLFkLkptCkwIiK0mmK8Y3zxjE0ReHrvNqVFw7fe9+953z3ngv8G98FUOwyFAMKfMvTps60KOzVtm1EdkdawB9/bgb2Ia8sC70C/0dkVUEkoWBYyChym1FQlw+700RBA3yxWUtPRpSPZMSh8xmhf1NwPhcwouCYEVZHPopcZpwjt3VFQVRTgOga4P8I3ONrmoAUjgPNi1CcU5CCyXb4k+NoXr4J9+cxBJJjCKpnFcfYnxqEYsAceU+Ilg9A2092GEzcQXj1PrzxBwiokwgnH/H0oHEesnceaHwNdJMgCOcLSP73gIt3gVUXQuoU/OR4yA1RI6RO6CMLpT0tjgyvC1vfmkBrWkj+L3dxnQJV1ywoOcXR6nOQU25DaWc2Kq9aMMmcZ/EWpxMlg2ui4sK6MHXR3yjBjjakqLZL03dMHaktRFL0aWkUo8xVXKZgm+6VhYKFKO3KRvklC8b1ET9d0Wtzu7Wtoj5tx3A6tcv/X4A3Vo3wZi2qHnpxcqFOCqVPwJeyoprdN70BGuY4HgXeEvUvWb8I6Sg9DGzkI6Qdh2OhDpXkBjZrpZZYDReSBNzvgAmBb7RU8tFoB4nuGeYSZ+BRb8P94waauBivOs67HjQ+hVQ/yy6X/no7TbgW+Ai1WCDD91XGRSHB5jQityZPtlabdW2ldWXm4FBGlBIHBjNi/0BGSBH1FXNZck6JSa+FtcGIEXJ9SzIC1NorDIeDWfophROPiwfSomwovWXv17bt/VxYeOUZU4rBXqHsxf0NQav7fv48jSUAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}}),"\n  ",Object(s.b)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"1",title:"1",src:"/refarch-eda/static/7d89ce5e07a872fa0fd516e3f88beef9/6ebf5/reactive-manifesto.png",srcSet:["/refarch-eda/static/7d89ce5e07a872fa0fd516e3f88beef9/7fc1e/reactive-manifesto.png 288w","/refarch-eda/static/7d89ce5e07a872fa0fd516e3f88beef9/6ebf5/reactive-manifesto.png 441w"],sizes:"(max-width: 441px) 100vw, 441px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"}),"\n    ")),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Responsive"),": deliver a consistent quality of service to end users or systems, react quickly and consistently to events happening in the system."),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Elastic"),": The system stays responsive under varying workload, it can scale up and down the resource utilization depending of the load to the system."),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Resilient"),": stay responsive in the face of failure, this is a key characteristics. It implies distributed systems."),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Message driven"),": the underlying behavior is to have an asynchronous message driven backbone, to enable loose coupling of the application components by exchanging asynchronous messages to minimize or isolate the negative effects of resource contention, coherency delays and inter-service communication network latency. It is the base to support the other reactive characteristics. It also helps for isolation and support location transparency.")),Object(s.b)("p",null,"Reactive architecture is an architecture approach aims to use asynchronous messaging or event driven architecture to build Responsive, Resilient and Elastic systems.\nRelying on message passing enables the ",Object(s.b)("em",{parentName:"p"},"responsive")," characteristics and more, like flow control\nby monitoring the messages in the system and applying backpressure when necessary."),Object(s.b)("p",null,"Under the “reactive” terms we can see two important caveats:"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Reactive systems")," is a group of application components which can heal and scale automatically. It address data consistency, cross domain communication, orchestration, failure, recovery… "),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Reactive programming")," is a subset of asynchronous programming and a paradigm where the availability of new information drives the logic forward rather than having control flow driven by a thread-of-execution. This is the adoption of non-blocking IO and event-based model.")),Object(s.b)("p",null,"The following figure illustrates well how those two paradigms work together to deliver business value:"),Object(s.b)("p",null," ",Object(s.b)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}},"\n      ",Object(s.b)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"57.29166666666667%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAACDElEQVQoz3WTTWsTURSGs3LtUvAPiH9A/49LNyK07uzarlUsbRGK6KJipcSG2EILVRTRRNBpvjpjJ1+TZJJMMvmcuTPzeO/EWkPqgXfmcjg895z3zCTazhCn26ZW1rEqOo5dpd+1cPouE08wnvpzmkwF7nCMWa5gGAamadJsNrHtNrZkJRx3xFG2wfJGkaWNEsvPK6y8rFNvdlARBgFRGMYKw0BmIgaDAe8/fOfN/ld2Dr6RPNbIajqdngRa7QGru0Ou3YPr9+HqXbhyJ6BUdhQOzxcIMZMvz6EEO70+rw511tNnrKV0Vl/nSX026LkS2JDAtXSXWw+H3F4ZcfPBmBtLLnrViTuMIhai7w7YPsyxtV9kM5Xj8VuNgy8laZMEllsjmnaPwq+GVIu8km4xGI5mI6txJVVJnVV4nke5UqNctWKZlTqtlo3aR8KwhvQn8x0EwpOAkE6nQzabIZPJoGlavAS1AAX2fW+h83bvD/CkBnorwp1EsenKK7kFzGqTF2mNrXSOzXca68mf/ChW1KbwpacXnUcXQPVQIYJIKnYtLlJh1m2eJgs829N5kjzl0XaOTL7219tz4Hn9HHCWnL+xZtnsfcyR+lRk9zjPzpFGwajOvP0HFl4GvCwiOVrgT2OF0tdQyHcg/lsfA9XXPZF/wGjiLWjq+7TaglNDYJwJuj0hc+LSWsVQW/4NfuwxXoPU7YUAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}}),"\n  ",Object(s.b)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"2",title:"2",src:"/refarch-eda/static/aee35b7f526adff5d57a0b0268d5f88d/3cbba/reactives.png",srcSet:["/refarch-eda/static/aee35b7f526adff5d57a0b0268d5f88d/7fc1e/reactives.png 288w","/refarch-eda/static/aee35b7f526adff5d57a0b0268d5f88d/a5df1/reactives.png 576w","/refarch-eda/static/aee35b7f526adff5d57a0b0268d5f88d/3cbba/reactives.png 1152w","/refarch-eda/static/aee35b7f526adff5d57a0b0268d5f88d/0b124/reactives.png 1728w","/refarch-eda/static/aee35b7f526adff5d57a0b0268d5f88d/a9d85/reactives.png 2138w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"}),"\n    ")),Object(s.b)("p",null,"We recommend to go over ",Object(s.b)("a",{parentName:"p",href:"https://ibm.biz/DefiningReactive"},"this excellent IBM article on defining reactive")," to go deeper into those concepts."),Object(s.b)("h3",null,"Commands and Events"),Object(s.b)("p",null,"Those two concepts are very fundamental to implement well distributed applications. "),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Commands"),": represent action a user or system wnats to perform. HTTP APIs pass commands. Commands are sent to a specific service and result is sent back to the caller."),Object(s.b)("li",{parentName:"ul"},Object(s.b)("strong",{parentName:"li"},"Events"),": Events are actions that have successfully completed. An event represents a fact. They are immutable. ")),Object(s.b)("p",null,"By looking at your solution in terms of commands and events, you focus on the behavior, workflow, instead of the structure."),Object(s.b)("p",null,"Events are wrapped into Messages. But Commands can also being passed via messaging and asynchronous communication. Most likely strong consistency is needed and queuing systems are used as message brokers."),Object(s.b)("h3",null,"Is it for me?"),Object(s.b)("p",null,"We have learnt from years of point to point microservice implementations, that embrassing\nasynchronous communication helps a lot to support scaling, integration, coupling and failover.\nSo adopting reactive design and implementation may look complex at first but is becoming a\nnecessity in the long run. In e-commerce, a lot of monolithic applications were redesigned\nto adopt reactive manifesto characteristics to support scaling the business needs and respond\nto sporadic demand. In the world of big data, collecting, aggregating, applying real time\nanalytics, decisions and AI need to scale and respond to events at the time of occurence. "),Object(s.b)("h2",null,"EDA and reactive systems"),Object(s.b)("p",null,"The adoption of event driven microservice implementation fits well into the reactive manifesto, where most of the work presented in this git repository started by adopting Kafka as event\nbackbone, it is too reductor to think EDA is just Kafka. EDA supports reactive systems at large, and developing event-driven microservice should use reactive libraries to support\nnon-blocking IO and event bus for inter process communication. Also microservices is part of the game, functions / serverless are also in scope and with serverless 2.0,\nKnative eventing is one of the new kid in the play."),Object(s.b)("p",null,"The manifesto stipulates “message driven” while EDA is about events and commands.\nEvents represent unmmutable data and facts about what happened, and components subscribe to those event\nstreams. Command demands the consumer to process the content data sent and gives an answer.\nBoth are sent via messages, and transported and managed by brokers.\nFor sure we define event-driven implementations to cover both. And we should not be purist and opinionated\nabout messaging versus eventing: it will not make any sense to say: you are using queue to exchange message\nwhile we produce events to topic. "),Object(s.b)("p",null,"The following figure illustrates the combination of synchronous communication, sending commands to reactive\nsystem, supported by reactive applications link together via messaging."),Object(s.b)("span",{className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"1152px"}},"\n      ",Object(s.b)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"30.208333333333332%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABMUlEQVQY011RW26DMBDk4D1Bb9CPSv3uBaKqZyAVRM2D0CRKSniEJOAX2BhPjVHTx0rjsXZHo9GuFx8ptjmD6XvUVGCfZHhfRIjiLfafKcoLAW86VERgu0+wWm+ws3w45lbP8VPGvd7dk4/75xCMMRQXjlUU4206RRgGmIUhzucSUrZ2TjGbhZj6vpvN53McSwbRSHDOQRtAaQNPqQ6q0869oi1O5RlFnqMoCuSW65qglRJCNMiyzPUGpPZ/qQW07m04fcvp/coMJlrHnAu0rcT1ekUQBA5RFDlDpRQIIU5H+ainQuFhssGLn8IzxmDAaCjHbZje8elUYLVcIl6vHSdJ4vpad38MKybxOFng1T+MCb8NK3uUAcQKB1R26bsDRfRBkaTUHoa5PnWzBoQ1+F9fjUXF3H7POsQAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}}),"\n  ",Object(s.b)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"reactive command",title:"reactive command",src:"/refarch-eda/static/e984d13030aa99c480a90465f6cc6799/3cbba/reactive-command.png",srcSet:["/refarch-eda/static/e984d13030aa99c480a90465f6cc6799/7fc1e/reactive-command.png 288w","/refarch-eda/static/e984d13030aa99c480a90465f6cc6799/a5df1/reactive-command.png 576w","/refarch-eda/static/e984d13030aa99c480a90465f6cc6799/3cbba/reactive-command.png 1152w","/refarch-eda/static/e984d13030aa99c480a90465f6cc6799/0b124/reactive-command.png 1728w","/refarch-eda/static/e984d13030aa99c480a90465f6cc6799/c28c5/reactive-command.png 1834w"],sizes:"(max-width: 1152px) 100vw, 1152px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"}),"\n    "),Object(s.b)("p",null,"With messaging applications can scale horizontally giving the elastic need of the reactive manifesto. They\nare also more resilient as messages are kept until consumed or for a long period of time and consumer can restart\nfrom where they were in the ordered log. "),Object(s.b)("p",null,"Reactive systems are not only exchanging messages. Sending and receiving messages must be done efficiently and Reactive promotes the use of nonblocking I/Os.\nWhich leads to reactive programming and supporting libraries, like Vert.x, Mutiny, reactive messaging…"),Object(s.b)("h2",null,"Technology review"),Object(s.b)("h3",null,"Concurrency"),Object(s.b)("p",null,"The following figure illustrates the traditional Java multi-threading approach to handle request and\naccess I/Os on a two CPUs computer. When the second thread starts working on the IO the CPU is locked\nand the CPU yellow is supporting 2 threads (1 and 3)"),Object(s.b)("p",null," ",Object(s.b)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"774px"}},"\n      ",Object(s.b)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"39.23611111111111%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsTAAALEwEAmpwYAAABmklEQVQoz2WRb08TQRDG+1H9AL7jjd/CFwoxNQUDCWKiL4iRRt6AQlBpERESjaYtlX93lLZ3197d3t7e/pzbqxF0sk9md2YyzzyztcXNDltHPmQnFOMdbPihQrB3C7vYqE1uCvJshB2/k9h7iuizi1nErJVjqT1otFjdOoVJEy6ewtUiXNbFL4G3LFgRyP36JakW3tiTugXJ17H+C+Ish9sNX+32af0YYoQn0BlKckYwEeabdMxQhYyyiCCPCNMzwsxjrGPJBcRSWFhcIzvztfvzH2m87eCLpK9n6wwmHiVp57rNp+4zDvpr7HxrsNF6xOaXJTbaT9g+qdPqLfNr+B1lmJkTTq253+e4N/oTxRQapQPumNTqOMVOrzBxiDV/axM9kgEyuc8mvPfwkMevO65/JHq7N4ccna9zGfRkPyJdaSbl7oJ9Sc5hvFX3nqqC7uCA44s3eOG5229RNvS7TZLpwDEWJifPK5gSpvJl3MgIOq92Vsmz/CejlPzz9Dmp8t1Da02apneQJAlKKcllJHHsyKpPtf+giv0GZZFZc9JGqK8AAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}}),"\n  ",Object(s.b)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"3",title:"3",src:"/refarch-eda/static/ec51e0241cf9add1d1b7c45d9c27a1aa/97191/conc-1.png",srcSet:["/refarch-eda/static/ec51e0241cf9add1d1b7c45d9c27a1aa/7fc1e/conc-1.png 288w","/refarch-eda/static/ec51e0241cf9add1d1b7c45d9c27a1aa/a5df1/conc-1.png 576w","/refarch-eda/static/ec51e0241cf9add1d1b7c45d9c27a1aa/97191/conc-1.png 774w"],sizes:"(max-width: 774px) 100vw, 774px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"}),"\n    ")),Object(s.b)("p",null,"On public clouds, the blocking I/O approach inflates your monthly bill; on private clouds,\nit reduces the deployment density."),Object(s.b)("p",null,"Non blocking IO framework or library adopts the ",Object(s.b)("inlineCode",{parentName:"p"},"reactor pattern")," where requests are internally\nasynchronous events processed, in order, by an event loop running in one thread, and handlers\n(or callbacks) are used to process the response."),Object(s.b)("p",null," ",Object(s.b)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"364px"}},"\n      ",Object(s.b)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"35.76388888888889%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABWklEQVQoz21RTU/CQBTsn/dKuGm8eTFCCIkc/MBIRDS2BcGCpSj9gqKRtlQKFALddtzSVojxJZN9mdnMvp3HEEIQBMG/iDRCT3+zgWcYWGh6DGME4vtbPQwD7CoEE4YhIuwbpVxaHjVZ2hMEyb1ZvQHfdbeaO/cg6Z94VUawHBeMaw7RrORQeLpEvsriusai91gAVyyi3+5gbtt443h0JAldUYSqqphQsw2dMCrF+EImV8bBSQkPzx0wy4ULQ5XACg2UqzVUKCSBgy71YJkmVpYFj0KhRq1mC4IgQFYUjGUZDuXrgojj8ztkz67AtyUwewGA0KyibML9VCg368sgtPeDOK/VxIGradu+K2s4LN4ic3oB9kWMM0xz27kkXGKwdhws9QEN0wOxbKwGw19N+xjjqHSPbP4GXDRhapQu4u9C0n4xnaLL8zDe+8k+41rTH9jONyw6tUcf/AE/ewvKS3Ti6gAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}}),"\n  ",Object(s.b)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"4",title:"4",src:"/refarch-eda/static/41639ce4800ee3b14845e8e928ada5f7/3c81c/reactor-pattern.png",srcSet:["/refarch-eda/static/41639ce4800ee3b14845e8e928ada5f7/7fc1e/reactor-pattern.png 288w","/refarch-eda/static/41639ce4800ee3b14845e8e928ada5f7/3c81c/reactor-pattern.png 364w"],sizes:"(max-width: 364px) 100vw, 364px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"}),"\n    ")),Object(s.b)("p",null,"The above figure and next one are coming from Clement Escoffier’s book\n",Object(s.b)("a",{parentName:"p",href:"https://developers.redhat.com/promotions/building-reactive-microservices-in-java"},"Building reactive microservice in Java"),"."),Object(s.b)("p",null,"In multi CPUs, cores and threading computer, the reactors can run in parallel, with one event\nloop per core:"),Object(s.b)("p",null," ",Object(s.b)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"298px"}},"\n      ",Object(s.b)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"45.138888888888886%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAACAElEQVQoz12SWU/bUBCF/Zu7SX0vz0hIfe7K1rSlUCWFZqFFRYRAE6pSCgEnLHESL4kd73ZMvl6bJVJHGs25V1dz5py5EiImk8l93kWKkyTh+vp6muk5vXddrJ8NfLmFE0VcdhQulR6hwNJ9o9tmURwz0FXWfvxivVLicPMdtZU1KuUSW4Uv/MoXsGSZyTgh7vf4+L3OzMJXnj5foLZfR5pOdFNt2yHwfbq6ycXVFVqnTf/8AqXTQbm4RBU1UDWCqw5hr8ff8y7VPzI7B0cMh0MkXdP4sLrCfG6RlfxnzKHJWEjjVmIsmMaCbDxJZScZ6ViQDqs1glYby3M5PZNpCbIwipGa29usz85SmJvlwaOHyEJOV+3TKKyTX83xorLG0kaVl+W8sCDH8dYnzKZ8Y4+Y8P23Os+WKjyem6e6u4fUrjfYWVhi8/UbKqUifhAQCx89MYWmqqgDHdUw6Q0MDEPDtgxC3cAT06WSW4rKwXGL3ycyrliWlG7Gdpws03AcG194GEc+QejhBj6hIBkHXuatGyUkoxFmbZ+wfY4m8OHxWdbQdr3pUu4iikL6msFJtUCxtMyr8irFYplGZZmNYoFceR+72czehl0lkzyzWObJ3Ft2a3vTb/P/Pwx8D9McYo4sLGuEPTJFFdhxiQYDXLGISNdpK8Lvo1MOT84yZf8A8U2QOzEPSisAAAAASUVORK5CYII=')",backgroundSize:"cover",display:"block"}}),"\n  ",Object(s.b)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"5",title:"5",src:"/refarch-eda/static/61eb4f5acb3b710f9bfe7950a22eb8bf/d5f9d/multi-reactors.png",srcSet:["/refarch-eda/static/61eb4f5acb3b710f9bfe7950a22eb8bf/7fc1e/multi-reactors.png 288w","/refarch-eda/static/61eb4f5acb3b710f9bfe7950a22eb8bf/d5f9d/multi-reactors.png 298w"],sizes:"(max-width: 298px) 100vw, 298px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"}),"\n    ")),Object(s.b)("p",null,"With non-blocking I/O the I/O operation can be allocated to another pool and the allocation of CPU\nto thread is well balanced: "),Object(s.b)("p",null," ",Object(s.b)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"710px"}},"\n      ",Object(s.b)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"44.09722222222222%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABmElEQVQoz5WRy47TMBRA+58sQbCBH0B8AaxgALEFsQAkJMQCicXMlLdmM1ULmo5aKhAtJUkfceI4b/tw63YWiGGBpaN7r51cn9x0uoOA18chtCFtKThwxQ/Iv+LyiYd8jG1Sf9Zady7WyaGszrV7n7i0N4DoKWXwgriWlybXcScXcMOLWyTPlx9QFSRFI7g/iIWi3jUcTJYcjxf833Ln74pl5+r9Iy7f6TEK33IwvE33dI+jb8+YrxShMoRxSiBqZvoYRleo5k9INqalFRypoDaGzc7wTX9Gtx/InQZdF2StFX1NFCUsIs1qmTGfx9TZCuopropkZvx7hjce9rj78tQXTfQKfj5A6ZDR4h2jaF84ZLw45CQ44Jdey6WIlfVmG/QulmeGt56PeLT/3Rdt+lm+5T1lrZipL8zivjDwTNc9smrtp9d4KzybvNlZ+oasxcoGW0N5IDWOTBsKUwsNVWEp89ZjMkNuDM5arLCJf/2Uj4ObLOKh36ibCq0T0jRFqZgkUZInKIk60xhplmWZj1pv67NGbjfD3/FAqEP6mMDtAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}}),"\n  ",Object(s.b)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"6",title:"6",src:"/refarch-eda/static/b2477022e838db28292cdd86d522103b/23d69/conc-2.png",srcSet:["/refarch-eda/static/b2477022e838db28292cdd86d522103b/7fc1e/conc-2.png 288w","/refarch-eda/static/b2477022e838db28292cdd86d522103b/a5df1/conc-2.png 576w","/refarch-eda/static/b2477022e838db28292cdd86d522103b/23d69/conc-2.png 710w"],sizes:"(max-width: 710px) 100vw, 710px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"}),"\n    ")),Object(s.b)("p",null,"Vert.X is the open source library to build such non-blocking I/O app, and using ",Object(s.b)("inlineCode",{parentName:"p"},"vertices")," to support\nscalable concurrent processor, which executes one event loop thread. ",Object(s.b)("inlineCode",{parentName:"p"},"vertices")," communicate asynchronously\nvia an event bus.  "),Object(s.b)("h3",null,"Reactive programming"),Object(s.b)("p",null,Object(s.b)("a",{parentName:"p",href:"https://reactivex.io/"},"Reactive programming is about observing asynchronous streams"),". Streams can be seen as a pipe in which events flow.\nWe observe the events flowing—such as items, failures, completion, cancellations—and implement side effects."),Object(s.b)("p",null,"You structure your code around streams and build chains of transformation, also called pipeline. Reactive programming libraries offer\ncountless operators that let you create, combine, filter, and transform the object emitted by streams."),Object(s.b)("p",null,"One important consideration is the speed of items processing by the consumer. If it is too slow compare to the producer, there will be a big proble, that\ncan be solved efficiency by using backprassure protocol. Reactive Streams is such backpressure protocol. It defines the concept of Subscriber\nwho requests the Publisher a certain amount of items. The consumer controls the flow, as when items are received and processed, consumers can ask for more.\nProducer is not strongly coupled to the consumer as they participate together to the stream processing. Producer uses a Subscription object to act as a contract\nbetween the participants."),Object(s.b)("p",null,"different libraries support the Reactive Streams protocol, like Mutiny, RxJava, Project Reactor…"),Object(s.b)("h3",null,"Vert.x"),Object(s.b)("p",null,"We do not need to reintroduce ",Object(s.b)("a",{parentName:"p",href:"https://vertx.io/"},"Vert.X"),", but with the large adoption of Quarkus\nto develop new JVM based microservice, Vert.x is an important library to understand. The main concepts\nused are:"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"An application would typically be composed of multiple vertices running in the same Vert.x instance and communicate with each other using events via the ",Object(s.b)("inlineCode",{parentName:"li"},"event bus"),"."),Object(s.b)("li",{parentName:"ul"},"vertices remain dormant until they receive a message or event."),Object(s.b)("li",{parentName:"ul"},"Message handling is ideally asynchronous, messages are queued to the event bus, and control is returned to the sender"),Object(s.b)("li",{parentName:"ul"},"Regular vertices are executed in the event loop"),Object(s.b)("li",{parentName:"ul"},"Worker vertices are not executed on the event loop, which means they can execute blocking code"),Object(s.b)("li",{parentName:"ul"},"Two event loops per CPU core thread"),Object(s.b)("li",{parentName:"ul"},"No thread coordination mechanisms to manipulate a verticle state"),Object(s.b)("li",{parentName:"ul"},"A verticle can be deployed several times as part of a container for example"),Object(s.b)("li",{parentName:"ul"},Object(s.b)("inlineCode",{parentName:"li"},"Event bus")," is used by different vertices to communicate through asynchronous message passing  (JSON)\n(point to point, pub / sub, req / resp)"),Object(s.b)("li",{parentName:"ul"},"We can have in memory event bus or clustered cross nodes, managed by Vert.x with a TCP protocol")),Object(s.b)("p",null,"Quarkus HTTP support is based on a non-blocking and reactive engine (Vert.x and Netty). All the HTTP requests your application receive are handled by event loops (IO Thread) and then are routed towards the code that manages the request. Depending on the destination, it can invoke the code managing the request on a worker thread (Servlet, Jax-RS) or use the IO Thread (reactive route)."),Object(s.b)("p",null," ",Object(s.b)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"406px"}},"\n      ",Object(s.b)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"92.70833333333334%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAAAsTAAALEwEAmpwYAAADz0lEQVQ4y3WUh1MbRxTG9ScmcRKcUBLsYYYSJpk43SUGgynGoToCJgZnHAjYwWBwgk01GnoTYAwIEZqEQAhUka7oTr/socimjN/Mu7vd2/fN971vd02IiMViJN6J7x3PEaOLLoZm15le3kGSFVYcASxzW7ycWWd120MwrDCx7D5eMyzmvYEwppNguq6TiJonC1y43s2n+f9wqfQlc7Ydvquf4mJ+Dx/l9VLUZKVn3E5SwRBphT1cLLTQM7kRB0yAGqEoqnhqVD1d5eObL0gr6ie9ZJCR+S1+aFwkuaCPTwoGuPVwhqcWGykl43xW2E3anQk6LSuYEkCSJPF6aYUVmx3r3DyV9c2UVNyn9G41NypasdvXuN/USdGdam6W1vPbowHGFzbIuttPTnE7WWW9DFvXMYVCR8iiP0srNpw7rmNwVYsx0tvBZFsxww+v8rj5AY1tg/S3VjDWdI2BPwpp+auLhr9fUfloivKWCQobhpi3OTFtO5y49z04xNsANkLXNa42zpFZPkaueZ4vzAtcvmcjNa+TtLwOUvOfkV42xqWqeTJqFskyL5Navkj70OpbyWej3+rG3LlEbfsM5rZp6p5MY263irGVuo7Z46xtm6C6ZYTKZgvFjX28WnWcNsVweXPLgc22ynVzD9kVFr68N05uzQTZlaOkF3SRUz5IZulzsn8Z5Ou6Gb4yT5FbPcblsmGeWV7HGUqSzO7uHlvbDnw+P4FgkORv63j/+8dklE+SU7tC2u1+Um49J7NmjtTCPvHdTWbVlPg/TnrxoHB7lM7htTigwczon6wobyTfeDDLe980k/JzO7m/zpL0458k/dRKTs0UyWLugyu/k1E2xOe3X3DhSgMfXuuie2z97cZORHwcY/cgiH1zly2XhzWnl+V1t0iXyD0W7U6W7FvYNvawbe6xtLrJ8r9OgqFwnGGijyfzzUbXICzpbLtlwnIMh0dh50B9l5enAc+Cy6qGzyuhaTqegCoAdXxBif3DEJoeP6qaSP3/NGpM5+WeiaB83AKvFCMchagi4T08SBScqzWdHESjOk6PhMeviNtFY1+wirjDaILpbiCKJABVYZzf7xfMxHrxiIpTZdQlcExnry9ZNE1WhRSxUBWyop4IkUgUl18Aqgqa7Cfo32f3UGbDFWLNEcQfUk8DvlOuMe+XhUwNb0QnIgXRlBABrxvXgSzAAvjEHWi0xCg/x9CQsO9T8AZVDoXcIyFbFqaERfMOjjQiqmAsWAYDAYwKQ8VZU08B6kJiSMgz8kjSkBThnhbvz7GrsfjFoaqJbRM7t0P+A5sNQm4bUPUEAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}}),"\n  ",Object(s.b)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"7",title:"7",src:"/refarch-eda/static/d74f5eaa8ebaa5e00063acbdfedc23b2/10841/quarkus-vertx.png",srcSet:["/refarch-eda/static/d74f5eaa8ebaa5e00063acbdfedc23b2/7fc1e/quarkus-vertx.png 288w","/refarch-eda/static/d74f5eaa8ebaa5e00063acbdfedc23b2/10841/quarkus-vertx.png 406w"],sizes:"(max-width: 406px) 100vw, 406px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"}),"\n    ")),Object(s.b)("p",null,"(Images src: quarkus.io)"),Object(s.b)("p",null,"The application code should be written in a non-blocking manner using SmallRye Mutiny or RsJava\nlibraries."),Object(s.b)("p",null,"So when interactive with different services using kafka as an inter service communication layer\nthe producer and consumer are handlers and the internal processing can be schematized as:"),Object(s.b)("p",null," ",Object(s.b)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"763px"}},"\n      ",Object(s.b)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"45.833333333333336%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0klEQVQoz22Sy27TUBCG/WywZMsOHgRWrNjAKyCxYhsugYpIaRJVqtQAvaWUFEhLQhLHTuPEcXw7Psf+GLuthAojfT6j0X9+eWaOZZY+k6NTfvf6TE7OhO/VOZKa0x+QzhYk9hWxoMYO5Ia8kKP83Aordjy2G022PjZotTtstzo0W23q77fY+/SZ21dSd0WuMpIsJ9OGYBNV+OuQVOpWOl9hYlVdzHROogwUuVBWClRm8NYxS2HuJ0QzrzIUBbbr8frNW+r1d9RqNRzHKQ19MQxROsZkEYVJMaKujCU+dMfcfdTk3pMOdx636O3/osg0mbS7DkJc12V+eYk9c8kyhZUtIjZOH2+6RzBtE6/67J85dI8H+KHC9iIaXyY0D6a0ew7e0AWt/xnFzTgtJS1HQUqYZGzCBG0KHC+k+3VCnGrO7YCXjQGvWhe8aJwz/mGDMYhMOskrtMyyHE1lqBc+SRBUgy23pk0pKoiVrgSdY5v7T3d4+GyXB893OT0cVn+Y6qullCjhZuOWb684OvzJ4NsQFeekqSFNRJRKnuSoMq8Qk7ImHWE0/4tCFmldDFxODkbyHqRdTza+vGY4wjgu+WpNLm+1QvJCaoW0XFwb/E0ZfwBvLKN6ljPfnAAAAABJRU5ErkJggg==')",backgroundSize:"cover",display:"block"}}),"\n  ",Object(s.b)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"8",title:"8",src:"/refarch-eda/static/12137a1b61517c8882c403f4cadf5363/0f699/quarkus-vertx-kafka.png",srcSet:["/refarch-eda/static/12137a1b61517c8882c403f4cadf5363/7fc1e/quarkus-vertx-kafka.png 288w","/refarch-eda/static/12137a1b61517c8882c403f4cadf5363/a5df1/quarkus-vertx-kafka.png 576w","/refarch-eda/static/12137a1b61517c8882c403f4cadf5363/0f699/quarkus-vertx-kafka.png 763w"],sizes:"(max-width: 763px) 100vw, 763px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"}),"\n    ")),Object(s.b)("p",null,"Vert.x and reactive messaging applications may be combined to byild reactive systems to support the reactive manifesto:"),Object(s.b)("p",null," ",Object(s.b)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"774px"}},"\n      ",Object(s.b)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"43.75%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB1ElEQVQoz4WR0WoTQRSG8ybeCF6KryAURLwVvCiIFyKlGNEL730AQQSxrbEiFkzRNJs2iakhVIttagytEU2yoVGTmGjbrY3d3WYz2d3PycYkVUHP8MPMnDPfmfnHF8tqzK1uklEbHA7DsplKFrk5nye09snbc1wXV+pf4bufvMDYxBTXHkR4kTOo1qqU1E2qlXWiK6cJL4+wmLnoFbuu/X9gszDOo9Qod5+PM5G4wsrqK8JKlDvBFNMPrzMXvEyrNvML6HjArhxnOO/lenNfd71XukQzf479sh/XbiNEm3DaT2BxlJmXY5iiI0/IJzt/37AP7zfwdbvaNphteYCeumHVbmGqfg4+3pAr8xDAoVwuk8vlqFQqng2/PbnX0fXGtqZR/7ZDtbFFyxoWFT6UeDqrEHoSYSm1TDqdJpFIkHn9BiUUY16JE19IYpoHfSDsNnXpXYSIojAbfIyqFgbATDHAZOwk9+KnWFi7Otjf2isyGR1h+tlZAvEz/DC+DoEtS6DrOk3d8OBmSyCkF0LmvtduU88coZE9hqaeHwAtPUcte5TG+nHqGyfoWF/w9Y39M7pe2o6LLVMdcxux+14qj73/mZ5JUsJA7GwgtLd0tHfyQy1+Ak9fjD8f8hVhAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}}),"\n  ",Object(s.b)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"9",title:"9",src:"/refarch-eda/static/85a6a6fabd94ad382e5c4c366aa52c92/97191/reactive-systems.png",srcSet:["/refarch-eda/static/85a6a6fabd94ad382e5c4c366aa52c92/7fc1e/reactive-systems.png 288w","/refarch-eda/static/85a6a6fabd94ad382e5c4c366aa52c92/a5df1/reactive-systems.png 576w","/refarch-eda/static/85a6a6fabd94ad382e5c4c366aa52c92/97191/reactive-systems.png 774w"],sizes:"(max-width: 774px) 100vw, 774px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"}),"\n    ")),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"To achieve ",Object(s.b)("strong",{parentName:"li"},"resilience")," and ",Object(s.b)("strong",{parentName:"li"},"responsiveness"),", microservice can scale vertically using vertices inside the JVM and horizontally via pod\nscaling capability within a Kubernetes cluster. The inter-communication between vertices is done via ",Object(s.b)("inlineCode",{parentName:"li"},"event bus")," and managed by the Vert.x library\nusing virtual addresses, service discovery and event bus. "),Object(s.b)("li",{parentName:"ul"},"Internal service communication (even cross pods) and external cross service boundary are ",Object(s.b)("strong",{parentName:"li"},"message driven"),". Using Kafka, they are also\ndurable improving resilience and recovery."),Object(s.b)("li",{parentName:"ul"},"Kubernetes enforces part of the reactive manifesto at the container level: ",Object(s.b)("strong",{parentName:"li"},"elasticity")," and resilience with automatic pod recovery and scheduling.")),Object(s.b)("h3",null,"MicroProfile reactive messaging"),Object(s.b)("p",null,"The ",Object(s.b)("a",{parentName:"p",href:"https://download.eclipse.org/microprofile/microprofile-reactive-messaging-1.0/microprofile-reactive-messaging-spec.pdf"},"MicroProfile Reactive messaging")," specification  aims  to  deliver  applications  embracing  the characteristics of reactive systems as stated by reactive manifesto. It enables non-blocking, asynchronous message passing between services, giving them the ability to scale, fail, and evolve independently."),Object(s.b)("p",null,"To summarize the main concepts, developer declares channels as way to get incoming or outgoing messages between CDI Java beans and connector to external message brokers:"),Object(s.b)("p",null," ",Object(s.b)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"719px"}},"\n      ",Object(s.b)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"44.79166666666667%",position:"relative",bottom:"0",left:"0",backgroundImage:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsTAAALEwEAmpwYAAABeklEQVQoz21STUvDQBDNL/Yg/ogK3gRBPIh48ePkISIVf4DopSYIIgpWpK1ps/na7yTP2a2JQTowye7w3pvZmQnatoXzoRlTA23tz0JpCKnp5DANSq58XEkJSd7xOw86Ma01ZrM5ARWapsHxzQtG509IC4VSGOxfPePk9hUVl7ANkOU5GGP4b4H7OIGKV5RRoSa0thajswl2jh4xZxKs1Ng6uKcEEZa5RNMOX2MghPgTzLIM4/HYe3gdYvo+Rco0TF1jky1WHIoqdh2ZfnwiDMOeX5YlAs454ihCHMeYTCbIWE5PrFEQqaZKTu/esHsRQZl1gqJSkNxAlRbL75XnOG5EGq6nwTB7TVUVZYGMSFxZH9u7jLF9+ACp1/duKK41m8wPxfXQ/aUioaoCp6kau/nJldCEb/3Q05QhSZKe76fcAYerI5RBVggiK8wShq9FiiUrfHyV8R7btk0v1mkEQ7Eui6vAVaiNBSfRStDO0T5aitnfyv/vbnf/AUCGsLAKQC4eAAAAAElFTkSuQmCC')",backgroundSize:"cover",display:"block"}}),"\n  ",Object(s.b)("img",{parentName:"span",className:"gatsby-resp-image-image",alt:"9",title:"9",src:"/refarch-eda/static/f57847ddad9a49b2fe7cb8efcffa6126/3f9cb/mp-reactive-msg.png",srcSet:["/refarch-eda/static/f57847ddad9a49b2fe7cb8efcffa6126/7fc1e/mp-reactive-msg.png 288w","/refarch-eda/static/f57847ddad9a49b2fe7cb8efcffa6126/a5df1/mp-reactive-msg.png 576w","/refarch-eda/static/f57847ddad9a49b2fe7cb8efcffa6126/3f9cb/mp-reactive-msg.png 719w"],sizes:"(max-width: 719px) 100vw, 719px",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",top:"0",left:"0"},loading:"lazy"}),"\n    ")),Object(s.b)("p",null,"The potential matching declarations for the connector, for the above figure, may look like below:"),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-shell"},"# Kafka connector to items topic mapped to the item-channel\nmp.messaging.incoming.item-channel.connector=smallrye-kafka\nmp.messaging.incoming.item-channel.topic=items\n\n")),Object(s.b)("p",null,"For code which defines the ‘outhoing’ and ‘incoming’ message processing see ",Object(s.b)("a",{parentName:"p",href:"https://quarkus.io/guides/reactive-messaging"},"this quarkus guide"),", the EDA quickstart code templates\nfor ",Object(s.b)("a",{parentName:"p",href:"https://github.com/ibm-cloud-architecture/eda-quickstarts/tree/main/quarkus-reactive-kafka-producer"},"producer")," and ",Object(s.b)("a",{parentName:"p",href:"https://github.com/ibm-cloud-architecture/eda-quickstarts/tree/main/quarkus-reactive-kafka-consumer"},"consumer")),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-Java"},'public class OrderService {\n\n    @Channel("orders")\n    public Emitter<OrderEvent> eventProducer;\n\n        public OrderEntity createOrder(OrderEntity order) {\n            try {\n            // build orderPayload based on cloudevent from order entity\n            Message<OrderEvent> record = KafkaRecord.of(order.getOrderID(),orderPayload);\n            eventProducer.send(record);\n            logger.info("order created event sent for " + order.getOrderID());\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n}\n')),Object(s.b)("p",null,"JMS and message driven bean, were the messaging APIs to asynchronously communicate with other applications.\nThey support transaction and so it is an heavier protocol to use. They do not support asynchronous IO. "),Object(s.b)("p",null,"When building microservices, the CQRS and event-sourcing patterns provide an answer to the data sharing between microservices.\nReactive Messaging can also be used as the foundation to CQRS and Event-Sourcing  mechanisms."),Object(s.b)("p",null,"A lot of EDA repositories demonstrating EDA concepts are using microprofile 3.0 Reactive Messaging, as it simplifies the implementation\nto produce or consume messages to messaging middleware like Kafka."),Object(s.b)("p",null,"When you use ",Object(s.b)("inlineCode",{parentName:"p"},"@Incoming")," and ",Object(s.b)("inlineCode",{parentName:"p"},"@Outgoing")," annotations, the runtime framework (Open Liberty or Quarkus) creates a Reactive Streams component for\neach method and joins them up by matching the channel names."),Object(s.b)("p",null,"A ",Object(s.b)("a",{parentName:"p",href:"https://quarkus.io/guides/kafka"},"simple guide")," from Quarkus web site with integration with Kafka. "),Object(s.b)("p",null,"Open Liberty supports this ",Object(s.b)("a",{parentName:"p",href:"https://openliberty.io/blog/2019/09/13/microprofile-reactive-messaging.html"},"specification implementation"),"."),Object(s.b)("h3",null,"Mutiny"),Object(s.b)("p",null,Object(s.b)("a",{parentName:"p",href:"https://smallrye.io/smallrye-mutiny"},"Mutiny")," is a modern reactive programming library to provide more natural, readable reactive code. It supports asynchrony, non-blocking programming and streams, events, back-pressure and data flows."),Object(s.b)("p",null,"With Mutiny both Uni and Multi expose event-driven APIs: you express what you want to do upon a given event (success, failure, etc.). These APIs are divided into groups (types of operations) to make it more expressive and avoid having 100s of methods attached to a single class."),Object(s.b)("p",null,Object(s.b)("a",{parentName:"p",href:"https://smallrye.io/smallrye-mutiny/#_uni_and_multi"},"This section of the product documentation")," goes over some examples on how to use Uni/ Multi."),Object(s.b)("h3",null,"AMQP"),Object(s.b)("p",null,Object(s.b)("a",{parentName:"p",href:"https://www.amqp.org/"},"Advanced Message Queueing Protocol")," is an international standard for interoperability between messaging middlewares. IBM MQ ",Object(s.b)("a",{parentName:"p",href:"https://www.ibm.com/support/knowledgecenter/en/SSFKSJ_9.2.0/com.ibm.mq.dev.doc/amqp_scen_clients_mq.htm"},"supports AMQP client")," via specific AMQP channel. Clients can connect to the queue manager and send / receive messages to / from queue. "),Object(s.b)("h3",null,"Knative eventing"),Object(s.b)("p",null,Object(s.b)("a",{parentName:"p",href:"https://knative.dev/"},"Knative")," is Kubernetes based platform to develop serverless. Major value proposition is a simplified deployment syntax with automated scale-to-zero and scale-out based on HTTP load. "),Object(s.b)("p",null,"Knative consists of the following components:"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"Eventing - Management and delivery of events"),Object(s.b)("li",{parentName:"ul"},"Serving - Request-driven compute that can scale to zero")),Object(s.b)("p",null,"See the ",Object(s.b)("a",{parentName:"p",href:"https://redhat-developer-demos.github.io/knative-tutorial/knative-tutorial/index.html"},"RedHat Knative cookbook"),"for a simple tutorial."),Object(s.b)("h2",null,"Code samples"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("a",{parentName:"li",href:"https://vertx.io/docs/vertx-kafka-client/java/"},"Vert.x kafka client")),Object(s.b)("li",{parentName:"ul"},Object(s.b)("a",{parentName:"li",href:"https://developer.ibm.com/tutorials/transforming-a-kafka-application-to-be-reactive/"},"Experiences writing a reactive Kafka application"))),Object(s.b)("h2",null,"More…"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("a",{parentName:"li",href:"https://www.oreilly.com/library/view/reactive-systems-explained/9781492077336/"},"Reactive Systems Explained - Book from Grace Jansen - Peter Gollmar")),Object(s.b)("li",{parentName:"ul"},Object(s.b)("a",{parentName:"li",href:"https://ide.skillsnetwork.site/reactive-java-workshop"},"Reactive Java Modules show how to build an event-driven, streams-optimized Kafka-based Java application. You will use the Eclipse MicroProfile Reactive Messaging API and Open Liberty to build it and then you’ll learn how to test it in true-to-production environments by using containers with MicroShed testing.")),Object(s.b)("li",{parentName:"ul"},Object(s.b)("a",{parentName:"li",href:"(https://www.ibm.com/cloud/architecture/architectures/resilience)"},"Resiliency discussion in IBM architecture center")),Object(s.b)("li",{parentName:"ul"},"Clement Escoffier’s book ",Object(s.b)("a",{parentName:"li",href:"https://developers.redhat.com/promotions/building-reactive-microservices-in-java"},"Building reactive microservice in Java"))))}u.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-advantages-reactive-index-mdx-495a0f173f5f2b390c1f.js.map